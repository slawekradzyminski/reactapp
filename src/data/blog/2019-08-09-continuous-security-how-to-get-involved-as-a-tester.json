{
  "id": "2019-08-09-continuous-security-how-to-get-involved-as-a-tester",
  "title": "Continuous Security - how to get involved as a tester?",
  "date": "2019-08-09",
  "category": "Security",
  "permalink": "/2019/08/continuous-security-how-to-get-involved",
  "content": "<img src=\"/images/blog/photo-1514302240736-b1fee5985889.jpeg\" alt=\"\">\n\n<p><strong>Introduction</strong></p><p>As you may have already noticed I often drift into the security domain. My interests focus mainly on continuous security (i.e. automated security tests). So far I had featured three tools on my blog: <a href=\"https://www.awesome-testing.com/2017/02/continuous-security-with-owasp.html\" target=\"_blank\" rel=\"noreferrer\">OWASP Dependency-Check</a>, <a href=\"https://www.awesome-testing.com/2018/12/continuous-security-with-owasp-zap.html\" target=\"_blank\" rel=\"noreferrer\">OWASP ZAP</a>, and <a href=\"https://www.awesome-testing.com/2018/11/continuous-security-with-find-sec-bugs.html\" target=\"_blank\" rel=\"noreferrer\">Find-Sec-Bugs</a> and showed how to use Selenium to automate your <a href=\"https://www.awesome-testing.com/2017/11/automate-your-xss-tests-with-selenium.html\" target=\"_blank\" rel=\"noreferrer\">XSS tests</a>.</p><p>When I talk to my peers on various testing meetups I&#39;m often surprised how rarely professional testers engage in security-related work. Throughout my activities, I try to debunk the myth that application security should be dealt with exclusively by full-time professionals. Of course, I&#39;m far from saying that their work is not needed (<a href=\"https://www.awesome-testing.com/2017/03/automated-testing-vs-manual-testing.html\" target=\"_blank\" rel=\"noreferrer\">quite contrary actually</a>), but testers should start to get themselves involved. I predict that companies will soon start to put <a href=\"https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project\" target=\"_blank\" rel=\"noreferrer\">OWASP Top 10</a> knowledge as a job requirement for testing positions.</p><p><strong>How to get involved?</strong></p><p>As with almost everything in life we need to start somewhere. How? Perhaps with the already featured <a href=\"https://www.awesome-testing.com/2018/12/continuous-security-with-owasp-zap.html\" target=\"_blank\" rel=\"noreferrer\">OWASP ZAP</a>. First, run an automated scan against your application. If you don&#39;t have any use <a href=\"https://www.owasp.org/index.php/OWASP_Juice_Shop_Project\" target=\"_blank\" rel=\"noreferrer\">OWASP Juice Shop</a>.</p><img src=\"/images/blog/Screenshot%2B2019-08-31%2Bat%2B12.29.25.png\" alt=\"\">\n\n<p>Most likely even with the simplest possible scan, you will be able to find vulnerabilities and things you can improve to make your application more secure. Here is sample output from <a href=\"https://www.owasp.org/index.php/OWASP_Juice_Shop_Project\" target=\"_blank\" rel=\"noreferrer\">OWASP Juice Shop</a>.</p><img src=\"/images/blog/Screenshot%2B2019-08-31%2Bat%2B12.45.27.png\" alt=\"\">\n\n<p>Today I&#39;ll focus on hardening (improving security) with <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers\" target=\"_blank\" rel=\"noreferrer\">security headers</a>. In the next post, I&#39;ll analyze what to do as a tester when an actual vulnerability has been found.</p><p><strong>Hardening</strong></p><p>If you take a look at my blog response headers you may find two security headers: <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection\" target=\"_blank\" rel=\"noreferrer\">X-Xss-Protection</a> and <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\" target=\"_blank\" rel=\"noreferrer\">X-Content-Type-Options</a>. Check it in browser developer tools though, scanning Blogger via OWASP ZAP is illegal.</p><p>It&#39;s usually a good idea to add a cheap API test just to make sure headers do not disappear during development. Let&#39;s use the newly released <a href=\"https://www.awesome-testing.com/2016/07/restful-api-testing-with-rest-assured-1.html\" target=\"_blank\" rel=\"noreferrer\">Rest-Assured</a> 4.0.0 framework for that purpose.</p><p>At first, it&#39;s good to list application endpoints we want to check. For me, it will be:</p><pre><code class=\"hljs language-java\">\n<span class=\"hljs-keyword\">abstract</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">AbstractSecurityHeaderTest</span> {\n\n    <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> List&lt;String&gt; CHECKED_URLS = ImmutableList.of(\n            <span class=\"hljs-string\">&quot;https://www.awesome-testing.com&quot;</span>,\n            <span class=\"hljs-string\">&quot;https://www.awesome-testing.com/search/label/security&quot;</span>,\n            <span class=\"hljs-string\">&quot;https://www.awesome-testing.com/2019/06/throttling-network-in-selenium-tests.html&quot;</span>,\n            <span class=\"hljs-string\">&quot;https://www.awesome-testing.com/2017/&quot;</span>\n    );\n\n}\n</code></pre><p>Test for X-Xss-Protection (header which enables cross-site scripting filtering):</p><pre><code class=\"hljs language-java\">\n    <span class=\"hljs-meta\">@Test</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">shouldHaveXssProtectionHeader</span><span class=\"hljs-params\">()</span> {\n        CHECKED_URLS.forEach(url -&gt; {\n            <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">header</span> <span class=\"hljs-operator\">=</span> given()\n                    .<span class=\"hljs-keyword\">when</span>()\n                    .get(url)\n                    .then()\n                    .extract()\n                    .header(<span class=\"hljs-string\">&quot;x-xss-protection&quot;</span>);\n\n            assertThat(header)\n                    .isNotNull()\n                    .isEqualTo(<span class=\"hljs-string\">&quot;1; mode=block&quot;</span>);\n        });\n    }\n</code></pre><p>And X-Content-Type-Options (header which disables MIME sniffing and forces browser to use the type given in Content-Type):</p><pre><code class=\"hljs language-java\">\n    <span class=\"hljs-meta\">@Test</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">shouldHaveContentTypeHeader</span><span class=\"hljs-params\">()</span> {\n        CHECKED_URLS.forEach(url -&gt; {\n            <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">header</span> <span class=\"hljs-operator\">=</span> given()\n                    .<span class=\"hljs-keyword\">when</span>()\n                    .get(url)\n                    .then()\n                    .extract()\n                    .header(<span class=\"hljs-string\">&quot;x-content-type-options&quot;</span>);\n\n            assertThat(header)\n                    .isNotNull()\n                    .isEqualTo(<span class=\"hljs-string\">&quot;nosniff&quot;</span>);\n        });\n    }\n</code></pre><p>Tests are really simple. If you have trouble understanding them please take a look at my <a href=\"https://www.awesome-testing.com/2016/07/restful-api-testing-with-rest-assured-1.html\" target=\"_blank\" rel=\"noreferrer\">Rest-Assured</a> introduction.</p><p><strong>TDD?</strong></p><p>Let&#39;s assume now that for some reason my blog needs to meet <a href=\"https://tidalcommerce.com/learn/merchant-levels-of-pci-compliance\" target=\"_blank\" rel=\"noreferrer\">PCI requirements</a> and I have to add two more headers:</p><p>a) <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\" target=\"_blank\" rel=\"noreferrer\">Strict-Transport-Security/HSTS</a> (header which forces communication using HTTPS instead of HTTP)</p><p>b) <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\" target=\"_blank\" rel=\"noreferrer\">X-Frame-Options</a> (header which indicates whether a browser should be allowed to render a page in a frame, iframe, embed or object)</p><p>In TDD fashion, I can start the work with the acceptance test. Developer job to add such header would be much easier now.</p><p>a) HSTS</p><pre><code class=\"hljs language-java\">\n    <span class=\"hljs-meta\">@Test</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">shouldHaveHstsHeader</span><span class=\"hljs-params\">()</span> {\n        CHECKED_URLS.forEach(url -&gt; {\n            <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">header</span> <span class=\"hljs-operator\">=</span> given()\n                    .<span class=\"hljs-keyword\">when</span>()\n                    .get(url)\n                    .then()\n                    .extract()\n                    .header(<span class=\"hljs-string\">&quot;strict-transport-security&quot;</span>);\n\n            assertThat(header)\n                    .isNotNull()\n                    .isEqualTo(<span class=\"hljs-string\">&quot;max-age=31536000; includeSubDomains&quot;</span>);\n        });\n    }\n</code></pre><p>b) X-Frame-Options</p><pre><code class=\"hljs language-java\">\n    <span class=\"hljs-meta\">@Test</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">shouldHaveXFrameOptionsHeader</span><span class=\"hljs-params\">()</span> {\n        CHECKED_URLS.forEach(url -&gt; {\n            <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">header</span> <span class=\"hljs-operator\">=</span> given()\n                    .<span class=\"hljs-keyword\">when</span>()\n                    .get(url)\n                    .then()\n                    .extract()\n                    .header(<span class=\"hljs-string\">&quot;x-frame-options&quot;</span>);\n\n            assertThat(header)\n                    .isNotNull()\n                    .isEqualTo(<span class=\"hljs-string\">&quot;deny&quot;</span>);\n        });\n    }\n</code></pre><p>Simple, right? :)</p><p>As usual, all code can be found on my <a href=\"https://github.com/slawekradzyminski/AwesomeTesting/commit/020d6e6de756beb21510ef91659b4b0d6e679ecf\" target=\"_blank\" rel=\"noreferrer\">GitHub project</a>. If you would like to support this blog please join 38 stargazers for a repository. Thank you.</p>"
}